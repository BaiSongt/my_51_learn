# my_51_learn
## 1、点亮一个LED
根据单片机原理图，LED 连接 P2 端口<br>
P2 端口地址为 0xA0 -> 0xA7 <br>
```c++
/* LED in 51 
 * LED order
 * D     1     2     3     4    5     6     7     8
 * P2    P2_0  P2_1  P2_2  P2_3 P2_4  P2_5  P2_6  P2_7
 * 
 * P2 in 51
 *  __sbit __at (0xA0) P2_0 ;
 *  __sbit __at (0xA1) P2_1 ;
 *  __sbit __at (0xA2) P2_2 ;
 *  __sbit __at (0xA3) P2_3 ;
 *  __sbit __at (0xA4) P2_4 ;
 *  __sbit __at (0xA5) P2_5 ;
 *  __sbit __at (0xA6) P2_6 ;
 *  __sbit __at (0xA7) P2_7 ;
 * 
 * order    8   ->  1
 * 默认高电平 1111 1111 = 0xFF
 * 点亮则拉低 1111 1110 = 0xFE
 */
```
- 函数:点亮LED_01<br>
`void LED_01_ON();`
- 函数:点亮第n个LED<br>
`void LED_ON(u8 LED_num);`
- 函数:循环LED 1——>8<br>
`void LED_circle();`

## 2、独立按键

独立按键连接P3的0-3口达到按键通断的输入，以控制P2口的LED. <br>
独立按键一侧接地，为低电平，另外一侧为高电平 <br>
按键接通，高电平转为低电平，key_n 1 -> 0 <br>
即 当按键电平为 0 时，按键按下，线路接通 <br>

```c++
/**
 * KEY in 51 
 * KEY order
 * D     K1    K2    K3    K4    
 * P3    P3_1  P3_0  P3_2  P3_3
 * 
 * P3 in 51
 * __sbit __at (0xB0) P3_0 ;
 * __sbit __at (0xB1) P3_1 ;
 * __sbit __at (0xB2) P3_2 ;
 * __sbit __at (0xB3) P3_3 ;
 * 
 * 默认高电平 1111 1111 = 0xFF
 * 点亮则拉低 1111 1110 = 0xFE
 * 
 * 按下点亮
 * 松手熄灭
 */
```
- `function` 独立按键控制第n个 LED <br>
  `void KEY_LED_n();`
- `function`  KEY_2 控制所有LED 按一下开，按一下关<br>
  `void KEY2_LED_PIN();`
- `function`  KEY_3 控制LED 显示二进制 <br>
  `void KEY3_show_LED_bin();`
- `function`  按一下KEY4 右移LED <br>
  `void KEY4_right_move_led();`
- `function`  按一下KEY1 左移LED <br>
  `void KEY1_left_move_led();`

## 3、数码管
数码管有共阴极连接，共阳极连接 <br>
引脚定义： 数码管显示一个数字8，加上一个小数点 一共8个LED 通过一个八位二进制正好控制一个数字 <br>
多个数码管，会共用引脚，四个数码管一组，8个针脚控制显示，4个针脚控制显示位置<br>
但是一次只能显示一个，由于人有视觉暂留，通过不断刷新数码管，起到动态显示的效果。 <br>
__138译码器__    3input   8 output Y0-Y7 <br>
使能：相当于一种开关 <br>
3个输入端: P22 P23 P24   二进制转10 <br>
101  5   Y5 -> 0  其他 = 1

__数码管的残影__ 
先位选，再段选，由于上一位显示后，信息没有清除，会影响下一位显示。 <br>
将显示内容清除，再显示，可以避免残影

- 函数:数码管显示<br>
`void Nixie(u8 location, u8 Number);`

## 4、LCD1602a
__引脚：__
- VSS GND
- VDD VCC
- VO  对比度调节-电位器
- RS  DATA/COMMAND  1-DATA 0-COM
- RW  READ/WRITE    1-R    0-W
- E   ENGIN   使能   1-数据有效 下降沿执行命令
- D0~D7 data in
- A   背光电源+
- K   背光电源-

__地址__<br>
0x80      0/0
0x80+0x40 1/0
number + 0x30

__时序结构__<br>
- init
```c++
// 0x38 八位数据接口，两行显示，5*7点阵
// 0x0C 显示开，光标关，闪烁关
// 0x06 读写操作后，光标自动加一，画面不动
// 0x01 clear 
```
- 显示字符
```c++
// 0x80|AC 设置光标位
// 发送数据
// ...
```
- 移屏 0x18

- functions
```c
void delay1ms(); //@12.000MHz
void LCD1602_WriteCommand(u8 com);
void LCD1602_WriteData(u8 data);

void LCD1602_Init();
void LCD1602_ShowChar(u8 line, u8 colum, unsigned char _char);
void LCD1602_ShowString(u8 line, u8 colum,u8 *_str);
void LCD1602_ShowNum(u8 line, u8 colum, u16 _num, u8 length);
void LCD1602_ShowSignedNum(u8 line, u8 colum, int _num, u8 length);
void LCD1602_ShowHexNum(u8 line, u8 colum, u16 _num, u8 length);
void LCD1602_ShowBinNum(u8 line, u8 colum, u16 _num, u8 length);
```

## 5、Matrix keys 矩阵键盘

1. 连接硬件：将矩阵按键的行和列分别连接到单片机的IO口上。行使用输入模式，列使用输出模式。 
2. 初始化：设置行为上拉输入，列为输出低电平。 
3. 扫描按键：循环扫描每一列，将当前列设置为高电平，读取行的状态。如果行为低电平，则表示有按键按下。 
4. 判断按键：根据行和列的对应关系，确定具体按下的按键。 
5. 处理按键：根据需要进行相应的操作，比如执行特定的功能或者发送按键信息。 
6. 延时：为了避免按键的抖动问题，可以在扫描按键之间添加适当的延时。 

## 6、定时器
51单片机的定时器可以分为两种类型：定时器/计数器模式和工作模式。
其中，定时器/计数器模式用于测量时间间隔或产生精确的延时，而工作
模式用于生成特定的脉冲信号。
1. 制作时钟
2. 代替长时间的Delay，提升CPU运行效率和处理速度

51单片机的定时器资源包括定时器/计数器模块、定时器控制寄存器和定时器中断。以下是一些常见的定时器资源：
 1. 定时器/计数器模块：51单片机通常具有至少一个定时器/计数器模块，用于测量时间间隔或产生延时。每个
 定时器/计数器模块通常包括一个16位的计数器和相关的控制逻辑。
 2. 定时器控制寄存器：每个定时器/计数器模块都有相应的控制寄存器，用于配置定时器的工作模式、计数方向
 、预分频系数等参数。通过设置这些寄存器的值，可以控制定时器的行为。
 3. 定时器中断：51单片机的定时器通常可以生成中断请求，在达到预设的计数值时触发中断。通过配置中断使
 能寄存器和中断优先级等参数，可以实现定时器中断的处理。
需要注意的是，具体的定时器资源和功能可能会因不同的型号和厂商而有所差异。因此，在使用51单片机的定时
器时，最好参考相关的芯片手册或开发工具的文档，以了解具体的资源和配置方式。

定时器是一种用于测量时间间隔或产生延时的设备或模块。它通常由一个计数器和相关的控制逻辑组成。计数器
根据时钟信号进行计数，并在达到预设的计数值时触发相应的操作。

 定时器的工作原理如下：
 1. 时钟源：定时器需要一个时钟源来提供计数的时钟信号。
 时钟源可以是外部晶体振荡器、外部信号源或者内部时钟源。
 2. 预分频器：定时器通常具有一个预分频器，用于将时钟源
 的频率分频为更低的频率。预分频器可以调节定时器的计数
 速度，以满足不同的时间精度要求。
 3. 计数器和计数值：定时器包含一个计数器，用于进行计数。
 计数器根据时钟信号进行递增或递减。当计数器达到预设的计
 数值时，触发相应的操作，如产生中断、改变输出状态等。
 4. 控制寄存器：定时器还包含一些控制寄存器，用于配置定
 时器的工作模式、计数方向、预分频系数等参数。通过设置这
 些寄存器的值，可以控制定时器的行为。
 5. 中断处理：定时器通常可以生成中断请求，在达到预设的
 计数值时触发中断。通过配置中断使能寄存器和中断优先级等
 参数，可以实现定时器中断的处理。
 通过合理配置定时器的工作模式、计数值和其他参数，可以
 实现各种功能，如周期性的定时中断、精确的延时生成、频
 率测量等。

 需要注意的是，不同的单片机和定时器模块可能会有不同的工
 作原理和功能。因此，在具体的应用中，需要参考相关的芯片
 手册或开发工具的文档，了解具体的定时器原理和使用方法。

 ___STC89C52___ 

定时器T0和T1的四种工作模式
 0. 13位定时器、计数器
 1. 16位定时器、计数器
 2. 8位自动重装模式
 3. 两个8位计数器

 STC89C52是一款基于8051架构的单片机，它具有丰富的中断资源。
 以下是STC89C52中断资源的简要介绍：
 1. 外部中断：STC89C52具有两个外部中断引脚，
 即INT0和INT1。这两个引脚可以用于外部触发的中断，
 例如外部按键的检测。
 2. 定时器/计数器中断：STC89C52内部集成了两个
 定时器/计数器，分别是Timer 0和Timer 1。这两
 个定时器可以通过设置相关寄存器来产生定时中断，
 用于精确的时间测量和延时控制。
 3. 串口中断：STC89C52支持串口通信，其中UART
 模块可以通过设置相关寄存器来产生接收和发送中断，
 用于异步串口通信的数据接收和发送。
 4. 外部中断优先级：STC89C52的中断优先级可以通
 过设置中断优先级寄存器来进行配置，可以根据需要设
 置不同中断的优先级，以确保高优先级中断的及时响应。
 需要注意的是，STC89C52的中断资源是有限的，因此
 在设计中需要合理规划中断的使用。在编程时，可以通
 过设置相关的中断使能寄存器、中断标志位和中断服务
 函数来实现中断的处理。
 
 以上是STC89C52中断资源的简要介绍，具体的中断使
 用方法和配置参数可以参考STC89C52的芯片手册或相
 关的开发工具文档。
